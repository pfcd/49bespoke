jQuery(function(r){function t(t){var e=t.attr("id"),n=-1!==e.indexOf("start")?"minDate":"maxDate",e="#"+("minDate"==n?e.replace("start","end"):e.replace("end","start")),i=t.datepicker("getDate");r(e).datepicker("option",n,i),r(t).change()}r("input[name^=ywctm_inquiry_form_where_show]").on("change, click",function(){r(this).is(":checked")&&"tab"===r(this).val()&&r("input[name^=ywctm_inquiry_form_style][value=classic]").prop("checked",!0).trigger("click").trigger("change")}).trigger("change"),r("input[name^=ywctm_inquiry_form_style]").on("change",function(){r(this).is(":checked")&&"toggle"===r(this).val()?r("input[name^=ywctm_inquiry_form_tab_title]").parent().parent().parent().hide():r("input[name^=ywctm_inquiry_form_tab_title]").parent().parent().parent().show(500)}).trigger("change"),r("select[name^=ywctm_inquiry_form_type]").on("change",function(){var t=r("#ywctm_reCAPTCHA"),e=r("div.yith-plugin-fw__panel__option.yith-plugin-fw__panel__option--ywctm-default-form"),n=e.closest(".yith-plugin-fw__panel__section");"default"!==r(this).val()&&"yes"===t.val()&&t.prop("checked",!1).val("no").removeClass("onoffchecked").trigger("change"),"default"!==r(this).val()?(e.hide(),n.hide()):(e.show(),n.show())}).trigger("change"),r(".ywctm-exclusions .yith-save-button").on("click",function(t){window.onbeforeunload=null;var e=r("#item_type").val(),n=r("#"+e+"_ids");if(0===n.find("option").length)return n.parent().find("small").remove(),n.parent().append('<small style="color:#ff0000">'+ywctm.error_messages[e]+"</small>"),r("html, body").animate({scrollTop:n.parent().offset().top-30},500),t.preventDefault(),!1}),r(".ywctm-exclusions #doaction, .ywctm-exclusions #doaction2, .ywctm-exclusions #ywctm-filter-submit, .ywctm-exclusions #search-submit, .ywctm-exclusions .pagination-links, .ywctm-exclusions .yith-add-button, .ywctm-exclusions .yith-update-button").on("click",function(){window.onbeforeunload=""}),r(".column-inquiry_form .on_off").on("change",function(){var t={action:"ywctm_enable_inquiry_form",item_id:r(this).parent().data("item-id"),enabled:r(this).val(),section:r(this).parent().data("section"),vendor_id:ywctm.vendor_id,_wpnonce:r("#_wpnonce").val()};r.post(ywctm.ajax_url,t)}),l(),r("#ywctm-new-time-range, #ywctm-new-date-range").on("click",function(t){t.preventDefault();var t="ywctm-new-time-range"===r(this).attr("id")?"time":"date",e=r(".ywctm-"+t+"-ranges"),n=e.find(".ywctm-"+t+"-range-row"),i=1,n=(n.each(function(){var t=r(this).data("index");i<t&&(i=t)}),i+1),t=wp.template("ywctm-"+t+"-range-row");r(t({index:n})).appendTo(e),r(document.body).trigger("wc-enhanced-select-init"),r(document.body).trigger("yith-framework-enhanced-select-init"),r(document.body).trigger("yith_fields_init")}),r("#ywctm_enable_geolocation").on("change",function(){"no"===r(this).val()&&r("#ywctm_enable_geolocation_maxmind").prop("checked",!1).val("no").removeClass("onoffchecked").trigger("change")}).trigger("change"),r("#ywctm_disable_shop").on("change",function(){"no"===r(this).val()&&(r("#ywctm_disable_shop_timerange").prop("checked",!1).val("no").removeClass("onoffchecked").trigger("change"),r("#ywctm_disable_shop_daterange").prop("checked",!1).val("no").removeClass("onoffchecked").trigger("change"))}).trigger("change"),r("#ywctm_disable_shop_timerange").on("change",function(){"no"===r(this).val()?r("#ywctm_disable_shop_timerange_ranges").find(".text input").each(function(){r(this).attr("required",!1)}):r("#ywctm_disable_shop_timerange_ranges").find(".text input").each(function(){r(this).attr("required",!0)})}).trigger("change"),r("#ywctm_disable_shop_daterange").on("change",function(){"no"===r(this).val()?r("#ywctm_disable_shop_daterange_ranges").find(".datepicker input").each(function(){r(this).attr("required",!1)}):r("#ywctm_disable_shop_daterange_ranges").find(".datepicker input").each(function(){r(this).attr("required",!0)})}).trigger("change"),r(document).on("click",".yith-icon.yith-icon-trash",function(){var t=r(this),e=t.closest("div.ywctm-time-range-row");(e=e.length?e:t.closest("div.ywctm-date-range-row")).remove()}),r(document.body).on("ywctm_add_error_tip",function(t,e,n){var i=e.position();0===e.parent().find(".wc_error_tip").length&&(e.after('<div class="wc_error_tip '+n+'">'+ywctm.error_messages[n]+"</div>"),e.parent().find(".wc_error_tip").css("width",150).css("left",i.left+e.width()-e.width()/2-r(".wc_error_tip").width()/2).css("top",i.top+e.height()).fadeIn("100"))}).on("blur",".ywctm-time-ranges-wrapper .text input",function(){r(".wc_error_tip").fadeOut("100",function(){r(this).remove()})}).on("keyup",".ywctm-time-ranges-wrapper .text input",function(t){var e=new RegExp("^"+r(this).prop("pattern")+"$","gi"),n=r(this).hasClass("ywctm-hours")?"error_hours":"error_minutes",i=r(this).val(),t=t.keyCode||t.which;e.test(i)||9===t?r(document.body).triggerHandler("wc_remove_error_tip",[r(this),n]):r(document.body).triggerHandler("ywctm_add_error_tip",[r(this),n])}),r.datepicker.setDefaults({onSelect:function(){t(r(this))}}),r(".yith-plugin-fw-datepicker").each(function(){r(this).each(function(){t(r(this))})});var s=r(document).find(".ywctm-exclusion-list-popup-wrapper"),_=s.find("form");function e(t,i,o){var a=r(".ywctm-exclusions");a.addClass("processing"),a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),r.ajax({url:t.attr("href"),success:function(t){var c,e,n;0<r(t).find(".ywctm-exclusion-list-popup-wrapper").length&&(r(".ywctm-exclusion-list-popup-wrapper").html("").html(r(t).find(".ywctm-exclusion-list-popup-wrapper").html()),c=i,t=o,s=r(document).find(".ywctm-exclusion-list-popup-wrapper"),e="insert"===c?ywctm.popup_labels.title:ywctm.popup_labels.edit,n="insert"===c?ywctm.popup_labels.save:ywctm.popup_labels.edit,(_=s.find("form")).find('input[name="action"').val(c),"edit"===c&&(_.find("#item_type").prop("disabled",!0),_.find("tr.item_type").hide(),_.find('input[name="item_id"').val(t)),s.dialog({closeText:"",title:e.replace(/&#039;/g,"'"),width:600,modal:!0,dialogClass:"yith-plugin-ui ywctm-exclusion-list-popup",buttons:[{text:n.replace(/&#039;/g,"'"),click:function(t){window.onbeforeunload=null;var e=r(".ywctm-exclusion-list-popup-wrapper"),n=e.hasClass("vendor-exclusion"),i=e.find("#item_type").val(),n=n&&"insert"===c||!n&&"edit"===c?e.find("#item_ids"):e.find("#"+i+"_ids");if("insert"===c&&0===n.find("option").length)return n.parent().find("small").remove(),n.parent().append('<small style="color:#ff0000">'+ywctm.error_messages[i]+"</small>"),t.preventDefault(),!1;_.submit()},"class":"yith-save-button"}],position:{my:"center center",at:"center center",of:"#wpwrap",collision:"fit"}}),r(document.body).trigger("wc-enhanced-select-init").trigger("yith-framework-enhanced-select-init").trigger("yith_fields_init"),l()),a.unblock()}})}function l(){var t=r("tr.ajax-products.product_ids"),e=r("tr.ajax-terms.category_ids"),n=r("tr.ajax-terms.tag_ids");r("#item_type, .ywctm-exclusion-list-popup-wrapper #item_type").on("change",function(){switch(r(this).val()){case"category":t.hide(),e.show(500),n.hide();break;case"tag":t.hide(),e.hide(),n.show(500);break;default:t.show(500),e.hide(),n.hide()}}).trigger("change"),r("#ywctm_enable_atc_custom_options").on("change",function(){"no"===r(this).val()?(r("tr.ywctm_atc_status").hide(),r("tr.ywctm_custom_button").hide(),r("tr.ywctm_custom_button_loop").hide()):r("tr.ywctm_atc_status").show(500),r("#ywctm_atc_status").trigger("change")}).trigger("change"),r("#ywctm_atc_status").on("change",function(){var t=r("#ywctm_enable_atc_custom_options").val();"show"===r(this).val()||"no"===t?(r("tr.ywctm_custom_button").hide(),r("tr.ywctm_custom_button_loop").hide()):(r("tr.ywctm_custom_button").show(500),r("tr.ywctm_custom_button_loop").show(500)),r("#ywctm_custom_button").trigger("change"),r("#ywctm_custom_button_loop").trigger("change")}).trigger("change"),r("#ywctm_enable_price_custom_options").on("change",function(){"no"===r(this).val()?(r("tr.ywctm_price_status").hide(),r("tr.ywctm_custom_price_text").hide()):r("tr.ywctm_price_status").show(500),r("#ywctm_price_status").trigger("change")}).trigger("change"),r("#ywctm_price_status").on("change",function(){var t=r("#ywctm_enable_price_custom_options").val();"show"===r(this).val()||"no"===t?r("tr.ywctm_custom_price_text").hide():r("tr.ywctm_custom_price_text").show(500),r("#ywctm_custom_price_text").trigger("change")}).trigger("change"),r("#ywctm_has_exclusion").on("change",function(){"no"===r(this).val()?(r("#ywctm_enable_atc_custom_options").prop("checked",!1).val("no").removeClass("onoffchecked").trigger("change"),r("#ywctm_enable_price_custom_options").prop("checked",!1).val("no").removeClass("onoffchecked").trigger("change"),r("tr.ywctm_enable_inquiry_form").hide(),r("tr.ywctm_enable_atc_custom_options").hide(),r("tr.ywctm_enable_price_custom_options").hide()):(r("tr.ywctm_enable_inquiry_form").show(500),r("tr.ywctm_enable_atc_custom_options").show(500),r("tr.ywctm_enable_price_custom_options").show(500))}).trigger("change"),r("#ywctm_custom_button").on("change",function(){var t=r("#ywctm_atc_status").val(),e=r("#ywctm_enable_atc_custom_options").val();-1===r.inArray(parseInt(r(this).val()),ywctm.buttons_custom_url)||"show"===t||"no"===e?r("tr.ywctm_custom_button_url").hide():r("tr.ywctm_custom_button_url").show(500)}).trigger("change"),r("#ywctm_custom_button_loop").on("change",function(){var t=r("#ywctm_atc_status").val(),e=r("#ywctm_enable_atc_custom_options").val();-1===r.inArray(parseInt(r(this).val()),ywctm.buttons_custom_url)||"show"===t||"no"===e?r("tr.ywctm_custom_button_loop_url").hide():r("tr.ywctm_custom_button_loop_url").show(500)}).trigger("change"),r("#ywctm_custom_price_text").on("change",function(){var t=r("#ywctm_price_status").val(),e=r("#ywctm_enable_price_custom_options").val();-1===r.inArray(parseInt(r(this).val()),ywctm.buttons_custom_url)||"show"===t||"no"===e?r("tr.ywctm_custom_price_text_url").hide():r("tr.ywctm_custom_price_text_url").show(500)}).trigger("change")}r(document).on("click",".yith-add-button",function(t){t.preventDefault(),e(r(this),"insert",0)}),r(document).on("click",".edit-exclusion a",function(t){t.preventDefault(),e(r(this),"edit",r(this).parent().data("item_id"))}),r(".ywctm-notice").on("click",".notice-dismiss",function(){r(this).parent().hide()}),history.pushState(null,"",location.href.replace(/&?_wpnonce=([^&]$|[^&]*)/i,"").replace(/&?_wp_http_referer=([^&]$|[^&]*)/i,""));var n=r(".page-title-action.yith-add-button"),i=r("#yith_wc_catalog_mode_panel_exclusions-items .yith-plugin-fw__panel__content__page .yith-plugin-fw__panel__content__page__title, #yith_wc_catalog_mode_panel_exclusions .yith-plugin-fw__panel__content__page .yith-plugin-fw__panel__content__page__title"),c=r("#yith_wc_catalog_mode_panel_exclusions-vendors .yith-plugin-fw__panel__content__page .yith-plugin-fw__panel__content__page__title");i.append(n),c.append(n),r(".ywctm-add-line-separator").prev(".option-element").before("<br/>"),r("#doaction").on("click",function(t){window.onbeforeunload=null;var e=r(this);"delete"===r(this).parent().find("select option:selected").val()&&(t.preventDefault(),yith.ui.confirm({title:ywctm.bulk_delete.confirm_title,message:ywctm.bulk_delete.confirm_message,confirmButtonType:"delete",confirmButton:ywctm.bulk_delete.confirm_button,cancelButton:ywctm.bulk_delete.cancel_button,closeAfterConfirm:!0,onConfirm:function(){e.closest("form").submit()}}))})});